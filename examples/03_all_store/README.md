<!--
SPDX-License-Identifier: MIT
Copyright (c) 2025 Advanced Micro Devices, Inc. All rights reserved.
-->

# All-Store benchmark

All-Store benchmark using Iris.

## Usage

```terminal
python examples/03_all_store/all_store_bench.py --num_ranks 8
```
On an MI300X, this example will run on 8 GPUs. It prints:

```terminal
Total Bandwidth (GiB/s) vs Buffer Size
Size (MiB) | log2(bytes) | GPU 00 | GPU 01 | GPU 02 | GPU 03 | GPU 04 | GPU 05 | GPU 06 | GPU 07
------------------------------------------------------------------------------------------------
       1.0 |          20 |  62.03 |  68.65 |  56.19 |  59.74 |  57.03 |  54.87 |  49.89 |  59.48
       2.0 |          21 |  65.47 |  62.74 |  56.77 |  63.31 |  64.02 |  53.99 |  50.63 |  54.86
       4.0 |          22 |  85.16 |  86.16 |  81.03 |  84.72 |  85.00 |  80.71 |  77.67 |  76.62
       8.0 |          23 | 117.99 | 112.11 | 110.42 | 125.86 | 113.66 | 108.62 |  99.27 | 105.15
      16.0 |          24 | 158.03 | 152.47 | 151.44 | 156.81 | 152.39 | 149.55 | 136.27 | 139.15
      32.0 |          25 | 204.38 | 195.76 | 198.34 | 201.89 | 201.17 | 196.28 | 181.58 | 182.14
      64.0 |          26 | 245.69 | 237.93 | 236.56 | 243.61 | 239.67 | 239.04 | 228.17 | 232.00
     128.0 |          27 | 270.47 | 271.11 | 267.27 | 271.52 | 270.12 | 266.27 | 258.16 | 260.52
     256.0 |          28 | 286.91 | 285.99 | 284.25 | 285.82 | 285.72 | 283.88 | 278.68 | 280.62
     512.0 |          29 | 296.52 | 296.20 | 294.40 | 294.47 | 295.60 | 294.08 | 289.00 | 291.86
    1024.0 |          30 | 300.88 | 300.73 | 299.32 | 299.18 | 300.30 | 299.08 | 294.91 | 296.78
    2048.0 |          31 | 301.46 | 301.30 | 301.09 | 300.34 | 301.90 | 300.15 | 297.09 | 297.60
    4096.0 |          32 | 301.71 | 302.13 | 301.32 | 300.12 | 302.17 | 301.13 | 297.46 | 298.81
```